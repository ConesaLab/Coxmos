<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Step-by-step guide to the MO-HDcox pipeline</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Step-by-step guide to the MO-HDcox
pipeline</h1>
<h4 class="author">Pedro Salguero García</h4>
<address class="author_afil">
Institute for Integrative Systems Biology (I2SysBio) and Polytechnic
University of Valencia, Valencia,
Spain<br><a class="author_email" href="mailto:#"><a href="mailto:pedrosalguerog@gmail.com" class="email">pedrosalguerog@gmail.com</a></a>
</address>
<h4 class="date">Last updated: 04 julio, 2023</h4>


<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#installation" id="toc-installation">Installation</a></li>
<li><a href="#getting-ready" id="toc-getting-ready">Getting
ready</a></li>
<li><a href="#input-data" id="toc-input-data">Input data</a></li>
<li><a href="#survival-models-for-lowhigh-dimensional-data-sets" id="toc-survival-models-for-lowhigh-dimensional-data-sets">Survival
models for low/high dimensional data sets</a>
<ul>
<li><a href="#traintest" id="toc-traintest">TRAIN/TEST</a></li>
<li><a href="#sb.spls-icox" id="toc-sb.spls-icox">SB.sPLS-ICOX</a></li>
<li><a href="#sb.spls-drcox" id="toc-sb.spls-drcox">SB.sPLS-DRCOX</a></li>
<li><a href="#mb.spls-drcox" id="toc-mb.spls-drcox">MB.sPLS-DRCOX</a></li>
<li><a href="#mb.spls-dacox" id="toc-mb.spls-dacox">MB.sPLS-DACOX</a></li>
</ul></li>
<li><a href="#comparing-multiple-survival-models" id="toc-comparing-multiple-survival-models">Comparing multiple survival
models</a>
<ul>
<li><a href="#comparing-for-multiple-evaluators-at-the-same-time." id="toc-comparing-for-multiple-evaluators-at-the-same-time.">Comparing
for multiple evaluators at the same time.</a></li>
<li><a href="#plot-comparison" id="toc-plot-comparison">Plot
comparison</a></li>
<li><a href="#computing-time-comparison-we-use-the-cross-validation-models" id="toc-computing-time-comparison-we-use-the-cross-validation-models">Computing
time comparison (we use the cross validation models)</a></li>
</ul></li>
<li><a href="#individual-interpretations-of-the-results" id="toc-individual-interpretations-of-the-results">Individual
interpretations of the results</a>
<ul>
<li><a href="#forest-plots" id="toc-forest-plots">Forest plots</a></li>
<li><a href="#ph-assumption" id="toc-ph-assumption">PH
Assumption</a></li>
<li><a href="#density-plots" id="toc-density-plots">Density
plots</a></li>
<li><a href="#studying-pls-model" id="toc-studying-pls-model">Studying
PLS model</a></li>
</ul></li>
<li><a href="#understanding-the-results-in-terms-of-the-original-variables-pls-models" id="toc-understanding-the-results-in-terms-of-the-original-variables-pls-models">Understanding
the results in terms of the original variables (PLS models)</a>
<ul>
<li><a href="#understanding-the-relative-contribution-per-variablecomponent" id="toc-understanding-the-relative-contribution-per-variablecomponent">Understanding
the relative contribution per variable/component</a></li>
<li><a href="#psudobeta" id="toc-psudobeta">Psudobeta</a></li>
<li><a href="#kaplan-meier" id="toc-kaplan-meier">Kaplan-Meier</a>
<ul>
<li><a href="#full-model" id="toc-full-model">Full model</a></li>
<li><a href="#components" id="toc-components">Components</a></li>
<li><a href="#original-variables" id="toc-original-variables">Original
variables</a></li>
</ul></li>
</ul></li>
<li><a href="#new-patients" id="toc-new-patients">New patients</a>
<ul>
<li><a href="#add-patient-to-density-plot" id="toc-add-patient-to-density-plot">Add patient to density
plot</a></li>
<li><a href="#cox-compare-patients" id="toc-cox-compare-patients">COX
compare patients</a></li>
</ul></li>
</ul>
</div>

<style type="text/css">
.main-container {
max-width: 1080px !important;
margin-left: auto;
margin-right: auto;
}
body {
max-width: 1080px !important;
margin-left: auto;
margin-right: auto;
}
</style>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The <strong>HDcox</strong> R package contains the necessary functions
to reproduce the pipeline in <a href>this paper*</a>, a study by
<em>Salguero-Garcia et al.</em> in which we analyze ….</p>
<p>The pipeline includes … basic analysis blocks:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Cross-validation and performing survival models for high
dimensional data sets</strong>. First, …</p></li>
<li><p><strong>Comparing multiple survival models</strong>. …</p></li>
<li><p><strong>Understanding the results in terms of the original
variables</strong>. …</p></li>
</ol>
</div>
<div id="installation" class="section level1">
<h1>Installation</h1>
<p>HDcox can be installed from GitHub using <code>devtools</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;ConesaLab/HDcox&quot;</span>, <span class="at">build_vignettes =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="getting-ready" class="section level1">
<h1>Getting ready</h1>
<p>To run the analyses in this vignette, you’ll first need to load
<code>HDcox</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load HDcox</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HDcox)</span></code></pre></div>
<p>In addition, we’ll require some additional packages for data
formatting. Most of them are signaled as <code>HDcox</code>
dependencies, so they will already be installed in your system.</p>
<p>To generate plots, we make use of the <code>RColorConesa</code> R
package. After install:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;devtools&quot;)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;ConesaLab/RColorConesa&quot;</span>)</span></code></pre></div>
<p>…you can load and set the theme of your R session as follows:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorConesa)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#theme_set(theme_colorConesa()) #under development</span></span></code></pre></div>
</div>
<div id="input-data" class="section level1">
<h1>Input data</h1>
<p>The HDcox pipeline requires two matrices as input. First one must be
the features under study, and the second one a matrix with two columns
called <strong>time</strong> and <strong>event</strong> for survival
information.</p>
<p>To generate the matrices, we first processed the data from … Details
to this process can be found in <a href>our manuscript</a> (see
Supplementary Note and Methods).</p>
<p>If you wish to reproduce the analyses in Salguero-Garcia et al. <a href="#id_1">[1]</a>), you can load the <code>X_multiomic</code> object
to use our dataset:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load dataset</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;X_multiomic&quot;</span>, <span class="at">package =</span> <span class="st">&quot;HDcox&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Y_multiomic&quot;</span>, <span class="at">package =</span> <span class="st">&quot;HDcox&quot;</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> X_multiomic</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> Y_multiomic</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(X_multiomic, Y_multiomic)</span></code></pre></div>
<p>These contain a <code>list</code> of three blocks and a
<code>data.frame</code> object. Out toy example has a total of
<strong>150 observations, 642 miRNAs and 369 proteins</strong>:</p>
<table style="width:100%;">
<colgroup>
<col width="19%" />
<col width="17%" />
<col width="15%" />
<col width="15%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">hsa-let-7a-2-3p</th>
<th align="right">hsa-let-7a-3p</th>
<th align="right">hsa-let-7a-5p</th>
<th align="right">hsa-let-7b-3p</th>
<th align="right">hsa-let-7b-5p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TCGA-A2-A0SV-01A</td>
<td align="right">9.344533</td>
<td align="right">228.00660</td>
<td align="right">56661.51</td>
<td align="right">155.1192</td>
<td align="right">57564.19</td>
</tr>
<tr class="even">
<td align="left">TCGA-A2-A0YT-01A</td>
<td align="right">25.031847</td>
<td align="right">134.54618</td>
<td align="right">56991.26</td>
<td align="right">103.2564</td>
<td align="right">64478.91</td>
</tr>
<tr class="odd">
<td align="left">TCGA-BH-A1F0-01A</td>
<td align="right">34.725664</td>
<td align="right">122.98673</td>
<td align="right">68110.05</td>
<td align="right">195.3319</td>
<td align="right">37871.23</td>
</tr>
<tr class="even">
<td align="left">TCGA-B6-A0IK-01A</td>
<td align="right">44.962897</td>
<td align="right">163.66495</td>
<td align="right">89585.87</td>
<td align="right">183.4486</td>
<td align="right">121455.58</td>
</tr>
<tr class="odd">
<td align="left">TCGA-E2-A1LE-01A</td>
<td align="right">15.392269</td>
<td align="right">87.54353</td>
<td align="right">188649.57</td>
<td align="right">109.6699</td>
<td align="right">54892.68</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">7529</th>
<th align="right">7531</th>
<th align="right">7534</th>
<th align="right">1978</th>
<th align="right">7158</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TCGA-A2-A0SV-01A</td>
<td align="right">0.025273</td>
<td align="right">-0.030661</td>
<td align="right">0.458350</td>
<td align="right">1.369000</td>
<td align="right">-0.40781</td>
</tr>
<tr class="even">
<td align="left">TCGA-A2-A0YT-01A</td>
<td align="right">0.348210</td>
<td align="right">0.347870</td>
<td align="right">0.891570</td>
<td align="right">-0.188540</td>
<td align="right">-0.13896</td>
</tr>
<tr class="odd">
<td align="left">TCGA-BH-A1F0-01A</td>
<td align="right">0.132340</td>
<td align="right">-0.348210</td>
<td align="right">0.078923</td>
<td align="right">0.227890</td>
<td align="right">-0.49063</td>
</tr>
<tr class="even">
<td align="left">TCGA-B6-A0IK-01A</td>
<td align="right">0.352670</td>
<td align="right">0.376670</td>
<td align="right">-0.285750</td>
<td align="right">-0.380980</td>
<td align="right">-1.43080</td>
</tr>
<tr class="odd">
<td align="left">TCGA-E2-A1LE-01A</td>
<td align="right">0.110140</td>
<td align="right">0.094990</td>
<td align="right">-0.159960</td>
<td align="right">-0.098148</td>
<td align="right">0.40160</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">time</th>
<th align="left">event</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TCGA-A2-A0SV-01A</td>
<td align="right">825</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">TCGA-A2-A0YT-01A</td>
<td align="right">723</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">TCGA-BH-A1F0-01A</td>
<td align="right">785</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">TCGA-B6-A0IK-01A</td>
<td align="right">571</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">TCGA-E2-A1LE-01A</td>
<td align="right">879</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>As can be observed, clinical variables were transform to binary/dummy
variables for factors.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ggp_density.event <span class="ot">&lt;-</span> <span class="fu">plot_events</span>(<span class="at">Y =</span> Y, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">categories =</span> <span class="fu">c</span>(<span class="st">&quot;Censored&quot;</span>,<span class="st">&quot;Death&quot;</span>), <span class="co">#name for FALSE/0 (Censored) and TRUE/1 (Event)</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y.text =</span> <span class="st">&quot;Number of observations&quot;</span>, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">roundTo =</span> <span class="fl">0.5</span>, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">max.breaks =</span> <span class="dv">15</span>) </span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ggp_density.event<span class="sc">$</span>plot</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABaAAAAQ4CAMAAADIPItgAAABSlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrYVkYozMzM6AAA6ADo6AGY6OgA6Ojo6OmY6ZmY6ZpA6ZrY6kJA6kLY6kNtNTU1NTW5NTY5Nbo5NbqtNjshmAABmADpmAGZmOgBmOjpmZjpmZmZmZpBmkGZmkLZmkNtmtttmtv9uTU1uTW5uTY5ubm5uq+SOTU2OTW6OTY6Obk2Oq6uOyP+QOgCQOjqQZgCQZjqQZmaQkDqQkGaQtpCQtraQttuQ27aQ2/+rbk2r5P+2ZgC2Zjq2kDq2kGa2kJC2tpC2tra2ttu2tv+227a229u22/+2/7a2/9u2///Ijk3I///bkDrbtmbbtpDbtrbbttvb27bb29vb2//b/9vb///kq27k/8jk///r6+vy8vL9xln/tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///84AldlAAAACXBIWXMAABM5AAATOQGPwlYBAAAgAElEQVR4nO3dcXsc131f8QUtlTUcS5YbQQ7JVrIVx6JswknI1q7rVCTT1HIjpQIpOaYthHFJyhTAff//dmcBkIsFsDOjey7ub+4936exKZr8dOc+4BG4GOzO5s4550JuVvoBOOecO38G2jnngs5AO+dc0Blo55wLOgPtnHNBZ6Cdcy7oDLRzzgWdgXbOuaD75oH+91Eb+cu1tLS0Ls8Cm4rOQGtpaTVvgU1FZ6C1tLSat8CmojPQWlpazVtgU9EZaC0treYtsKnoDLSWllbzFthUdAZaS0ureQtsKjoDraWl1bwFNhWdgdbS0mreApuKzkBraWk1b4FNRWegtbS0mrfApqIz0FpaWs1bYFPRGWgtLa3mLbCp6Ay0lpZW8xbYVHQGWktLq3kLbCo6A62lpdW8BTYVnYHW0tJq3gKbis5Aa2lpNW+BTUVnoLW0tJq3wKaiM9BaWlrNW2BT0RloLS2t5i2wqegMtJaWVvMW2FR0BlpLS6t5C2wqOgOtpaXVvAU2FZ2B1tLSat4Cm4rOQGtpaTVvgU1FZ6C1tLSat8CmojPQWlpazVtgU9EZaC0treYtsKnoDLSWllbzFthUdAZaS0ureQtsKjoDraWl1bwFNhWdgdbS0mreApuKzkBraWk1b4FNRWegtbS0mrfApqIz0FpaWs1bYFPRGWgtLa3mLbCp6Ay0lpZW8xbYVHQGWktLq3kLbCo6A62lpdW8BTYVnYHW0tJq3gKbiq7uQP9HYDkel5aWVigLbCo6A22gtbSat8CmojPQBlpLq3kLbCo6A22gtbSat8CmojPQBlpLq3kLbCo6A22gtbSat8CmojPQBlpLq3kLbCo6A22gtbSat8CmojPQBlpLq3kLbCo6A22gtbSat8CmojPQBlpLq3kLbCo6A22gtbSat8CmojPQBlpLq3kLbCo6A22gtbSat8CmovvmgZ7CiECXvgbnXLPzM+i+5XhcWlpaoSywqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAbaC2t5i2wqegMtIHW0mreApuKzkAb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" width="100%" /></p>
</div>
<div id="survival-models-for-lowhigh-dimensional-data-sets" class="section level1">
<h1>Survival models for low/high dimensional data sets</h1>
<p>After loading the data, it may be of interest for the user to perform
a survival analysis in order to examine the relationship between
explanatory variables and the outcome. However, traditional methods are
only applicable for low-dimensional datasets. To address this issue, we
have developed a set of functions that make use of (s)PLS techniques in
combination with Cox analysis for the analysis of high-dimensional
datasets.</p>
<p><em>HDcox</em> provides the following methodologies for multi-omic
approaches:</p>
<ul>
<li>sPLS approaches: SB.sPLS-ICOX, SB.sPLS-DRCOX, MB.sPLS-DRCOX-Dynamic
and MB.sPLS-DACOX-Dynamic.</li>
</ul>
<p>More information for each approach could be found in the help section
for each function. The function name for each methodology are:</p>
<ul>
<li>sPLS approaches: sb.splsicox(), sb.splsdrcox(), mb.splsdrcox() and
mb.splsdacox().</li>
</ul>
<p>To perform a survival analysis with our example, we will use
methodologies that can work with high-dimensional data. These are the
set of methodologies that use sPLS techniques.</p>
<p>The first thing we are going to do is split our data into a train and
test set. This split will be made with a proportion of 70% of the data
for training and 30% for testing.</p>
<div id="traintest" class="section level2">
<h2>TRAIN/TEST</h2>
<p>We will use the function <code>createDataPartition</code> from the R
package <strong>caret</strong>. We will use a 70%/30% split for training
and testing, respectively, and set a seed for reproducible results.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>index_train <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">createDataPartition</span>(Y<span class="sc">$</span>event,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">p =</span> .<span class="dv">7</span>, <span class="co">#70 %</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">list =</span> <span class="cn">FALSE</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">times =</span> <span class="dv">1</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>X_train <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>X_test <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(omic <span class="cf">in</span> <span class="fu">names</span>(X)){</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  X_train[[omic]] <span class="ot">&lt;-</span> X[[omic]][index_train,,drop<span class="ot">=</span>F]</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  X_test[[omic]] <span class="ot">&lt;-</span> X[[omic]][<span class="sc">-</span>index_train,,drop<span class="ot">=</span>F]</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>Y_train <span class="ot">&lt;-</span> Y[index_train,]</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>Y_test <span class="ot">&lt;-</span> Y[<span class="sc">-</span>index_train,]</span></code></pre></div>
<p>EVP per block:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>EPV <span class="ot">&lt;-</span> <span class="fu">getEPV.mb</span>(X_train, Y_train)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="fu">names</span>(X_train)){</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">&quot;EPV = &quot;</span>, <span class="fu">round</span>(EPV[[b]], <span class="dv">4</span>), <span class="st">&quot;, for block &quot;</span>, b))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; EPV = 0.0794, for block mirna</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; EPV = 0.1382, for block proteomic</span></span></code></pre></div>
<p>As classical and PLS approach can not be perform in multiomic data,
several multiomic methods have been designed. The methods are divided
into two categories:</p>
<ol style="list-style-type: decimal">
<li><strong>Single-Block approach</strong>: Each omic will be studied
individually to reduce their dimensionality in order to explain the
survival. Then, integration of all omics will be run to obtain the final
model.</li>
<li><strong>Multi-Omic-Block approach</strong>: All omics will be
studied together by multiblock sPLS functions. After reduce the
dimensionality, the latent variables will be used to obtain the final
model.</li>
</ol>
<p>But first, we establish the center and scale for each block:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>x.center <span class="ot">=</span> <span class="fu">c</span>(<span class="at">mirna =</span> T, <span class="at">proteomic =</span> T) <span class="co">#if vector, must be named</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>x.scale <span class="ot">=</span> <span class="fu">c</span>(<span class="at">mirna =</span> F, <span class="at">proteomic =</span> F) <span class="co">#if vector, must be named</span></span></code></pre></div>
</div>
<div id="sb.spls-icox" class="section level2">
<h2>SB.sPLS-ICOX</h2>
<p>In our pursuit of addressing the challenges posed by high-dimensional
multi-omic data, we have developed SB.sPLS-ICOX, an innovative algorithm
that combines the strengths of sPLS-ICOX and integrative analysis.
SB.sPLS-ICOX employs a single-block approach, applying sPLS-ICOX
individually to each omic, resulting in dimensionality reduction within
each dataset. By constructing weights based on univariate cox models, we
capture survival information during the reduction process. The reduced
omic datasets are then integrated to create a comprehensive survival
model using their PLS components. Cross-validation is utilized to
determine the optimal number of components and the penalty for variable
selection, ensuring robust model optimization.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run cv.sb.splsicox</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>cv.sb.splsicox_res <span class="ot">&lt;-</span> <span class="fu">cv.sb.splsicox</span>(<span class="at">X =</span> X_train, <span class="at">Y =</span> Y_train,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">max.ncomp =</span> <span class="dv">2</span>, <span class="at">spv_penalty.list =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.9</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">n_run =</span> <span class="dv">2</span>, <span class="at">k_folds =</span> <span class="dv">5</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">x.center =</span> x.center, <span class="at">x.scale =</span> x.scale, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">remove_near_zero_variance =</span> T, <span class="at">remove_zero_variance =</span> F, <span class="at">toKeep.zv =</span> <span class="cn">NULL</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">remove_variance_at_fold_level =</span> F,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">remove_non_significant_models =</span> F, <span class="at">alpha =</span> <span class="fl">0.05</span>, </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">w_AIC =</span> <span class="dv">0</span>, <span class="at">w_c.index =</span> <span class="dv">0</span>, <span class="at">w_AUC =</span> <span class="dv">1</span>, <span class="at">w_BRIER =</span> <span class="dv">0</span>, <span class="at">times =</span> <span class="cn">NULL</span>, <span class="at">max_time_points =</span> <span class="dv">15</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">MIN_AUC_INCREASE =</span> <span class="fl">0.01</span>, <span class="at">MIN_AUC =</span> <span class="fl">0.8</span>, <span class="at">MIN_COMP_TO_CHECK =</span> <span class="dv">3</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">pred.attr =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">pred.method =</span> <span class="st">&quot;cenROC&quot;</span>, <span class="at">fast_mode =</span> F,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">MIN_EPV =</span> <span class="dv">5</span>, <span class="at">return_models =</span> F, <span class="at">remove_non_significant =</span> F, <span class="at">returnData =</span> F,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">PARALLEL =</span> F, <span class="at">verbose =</span> F, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 5 components could be use.</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Training all possible models for SB.sPLS-ICOX...</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Creating sub-models for SB.sPLS-ICOX...</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Evaluating COX models (AIC and C-Index)...</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Evaluating prediction acuracy with Brier Score... [BEST_MODE]</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Evaluating prediction acuracy with cenROC algorithm... [BEST_MODE]</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Best model obtained.</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>cv.sb.splsicox_res <span class="co">#3.2min</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The cross validation method used is cv.SB.sPLS-ICOX.</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Best model is:</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   n.comps eta n.var      AIC   c_index     BRIER       AUC     score</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       1 0.9 59_24 229.3474 0.8192258 0.4864428 0.4940464 0.9021641</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot cv.splsicox</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>cv.sb.splsicox_res<span class="sc">$</span>plot_AUC</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 1 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<p>We will generate a SB.sPLS-ICOX model with optimal number of
principal components and its penalty based on the results obtained from
the cross validation.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sb.splsicox_model <span class="ot">&lt;-</span> <span class="fu">sb.splsicox</span>(<span class="at">X =</span> X_train, <span class="at">Y =</span> Y_train,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n.comp =</span> cv.sb.splsicox_res<span class="sc">$</span>opt.comp, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">spv_penalty =</span> cv.sb.splsicox_res<span class="sc">$</span>opt.spv_penalty,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x.center =</span> x.center, <span class="at">x.scale =</span> x.scale,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">remove_near_zero_variance =</span> T, <span class="at">remove_zero_variance =</span> F, <span class="at">toKeep.zv =</span> <span class="cn">NULL</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">remove_non_significant =</span> F, </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">MIN_EPV =</span> <span class="dv">5</span>, </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">returnData =</span> T, <span class="at">verbose =</span> F)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 5 components could be use.</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>sb.splsicox_model</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The method used is SB.sPLS-ICOX.</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Survival model:</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                        coef exp(coef)   se(coef)  robust se          z</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp_1_mirna      0.1077358 1.1137534 0.01865296 0.01661403  6.4846281</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp_1_proteomic -0.1416963 0.8678848 0.23679243 0.24770216 -0.5720431</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      Pr(&gt;|z|)</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp_1_mirna     8.895092e-11</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp_1_proteomic 5.672928e-01</span></span></code></pre></div>
<p>In case some components get a P-Value greater than the cutoff for
significant, we can drop them by the parameter
“remove_non_significant”.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sb.splsicox_model <span class="ot">&lt;-</span> <span class="fu">sb.splsicox</span>(<span class="at">X =</span> X_train, <span class="at">Y =</span> Y_train,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n.comp =</span> cv.sb.splsicox_res<span class="sc">$</span>opt.comp,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">spv_penalty =</span>cv.sb.splsicox_res<span class="sc">$</span>opt.spv_penalty,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x.center =</span> x.center, <span class="at">x.scale =</span> x.scale,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">remove_near_zero_variance =</span> T, <span class="at">remove_zero_variance =</span> F, <span class="at">toKeep.zv =</span> <span class="cn">NULL</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">remove_non_significant =</span> T,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">MIN_EPV =</span> <span class="dv">5</span>, </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">returnData =</span> T, <span class="at">verbose =</span> F)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 5 components could be use.</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>sb.splsicox_model</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The method used is SB.sPLS-ICOX.</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Survival model:</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                    coef exp(coef)   se(coef)  robust se        z     Pr(&gt;|z|)</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp_1_mirna 0.09954254  1.104665 0.01257348 0.01573434 6.326453 2.508607e-10</span></span></code></pre></div>
<p>In this case, we optimized each omic/block to use the same number of
components. But there is another methodology that allow to select a
different number of components per block call “fast.sb.splsicox”.</p>
<p>In this case, the cross validation returns the model
automatically.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run cv.sb.splsicox</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>fast.sb.splsicox_model <span class="ot">&lt;-</span> <span class="fu">fast.cv.sb.splsicox</span>(<span class="at">X =</span> X_train, <span class="at">Y =</span> Y_train,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">max.ncomp =</span> <span class="dv">2</span>, <span class="at">spv_penalty.list =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.9</span>),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">n_run =</span> <span class="dv">2</span>, <span class="at">k_folds =</span> <span class="dv">5</span>, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">x.center =</span> x.center, <span class="at">x.scale =</span> x.scale, </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                                               <span class="co">#y.center = FALSE, y.scale = FALSE,</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">remove_near_zero_variance =</span> T, <span class="at">remove_zero_variance =</span> F, <span class="at">toKeep.zv =</span> <span class="cn">NULL</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">remove_variance_at_fold_level =</span> F,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">remove_non_significant_models =</span> F, <span class="at">alpha =</span> <span class="fl">0.05</span>, </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">w_AIC =</span> <span class="dv">0</span>, <span class="at">w_c.index =</span> <span class="dv">0</span>, <span class="at">w_AUC =</span> <span class="dv">1</span>, <span class="at">w_BRIER =</span> <span class="dv">0</span>, <span class="at">times =</span> <span class="cn">NULL</span>, <span class="at">max_time_points =</span> <span class="dv">15</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">MIN_AUC_INCREASE =</span> <span class="fl">0.01</span>, <span class="at">MIN_AUC =</span> <span class="fl">0.8</span>, <span class="at">MIN_COMP_TO_CHECK =</span> <span class="dv">3</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">pred.attr =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">pred.method =</span> <span class="st">&quot;cenROC&quot;</span>, <span class="at">fast_mode =</span> F,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">MIN_EPV =</span> <span class="dv">5</span>, <span class="at">return_models =</span> F, <span class="at">remove_non_significant =</span> T,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">PARALLEL =</span> F, <span class="at">verbose =</span> F, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 5 components could be use.</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Running cross validation SB.sPLS-ICOX for block: mirna</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Training all possible models for sPLS-ICOX...</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Creating sub-models for sPLS-ICOX...</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Evaluating COX models (AIC and C-Index)...</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Evaluating prediction acuracy with Brier Score... [BEST_MODE]</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Evaluating prediction acuracy with cenROC algorithm... [BEST_MODE]</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Best model obtained.</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Running cross validation SB.sPLS-ICOX for block: proteomic</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Training all possible models for sPLS-ICOX...</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Creating sub-models for sPLS-ICOX...</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Evaluating COX models (AIC and C-Index)...</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Evaluating prediction acuracy with Brier Score... [BEST_MODE]</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Evaluating prediction acuracy with cenROC algorithm... [BEST_MODE]</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Best model obtained.</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>fast.sb.splsicox_model <span class="co">#3.5min.</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The method used is SB.sPLS-ICOX.</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; A total of 1 variables have been removed due to non-significance filter inside cox model.</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Survival model:</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                    coef exp(coef)    se(coef)   robust se        z    Pr(&gt;|z|)</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp_1_mirna 0.06542979  1.067618 0.009080405 0.007714863 8.481004 2.23258e-17</span></span></code></pre></div>
</div>
<div id="sb.spls-drcox" class="section level2">
<h2>SB.sPLS-DRCOX</h2>
<p>We have developed also SB.sPLS-DRCOX, a comprehensive algorithm that
employs the individual sPLS-DRCOX approach, executing the algorithm on
each omic dataset independently to achieve dimensionality reduction. By
integrating the resulting components, a unified survival model is
constructed, capturing the collective information from all omics.
Similar to SB.sPLS-ICOX, cross-validation is employed to identify the
optimal number of components and penalty for variable selection,
ensuring robust model optimization.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run cv.sb.splsicox</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>cv.sb.splsdrcox_res <span class="ot">&lt;-</span> <span class="fu">cv.sb.splsdrcox</span>(<span class="at">X =</span> X_train, <span class="at">Y =</span> Y_train,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">max.ncomp =</span> <span class="dv">2</span>, <span class="at">eta.list =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.9</span>),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">n_run =</span> <span class="dv">2</span>, <span class="at">k_folds =</span> <span class="dv">10</span>, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">x.center =</span> x.center, <span class="at">x.scale =</span> x.scale,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="co">#y.center = FALSE, y.scale = FALSE,</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">remove_near_zero_variance =</span> T, <span class="at">remove_zero_variance =</span> F, <span class="at">toKeep.zv =</span> <span class="cn">NULL</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">remove_variance_at_fold_level =</span> F,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">remove_non_significant_models =</span> F, <span class="at">alpha =</span> <span class="fl">0.05</span>, </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">w_AIC =</span> <span class="dv">0</span>, <span class="at">w_c.index =</span> <span class="dv">0</span>, <span class="at">w_AUC =</span> <span class="dv">1</span>, <span class="at">w_BRIER =</span> <span class="dv">0</span>, <span class="at">times =</span> <span class="cn">NULL</span>, <span class="at">max_time_points =</span> <span class="dv">15</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">MIN_AUC_INCREASE =</span> <span class="fl">0.01</span>, <span class="at">MIN_AUC =</span> <span class="fl">0.8</span>, <span class="at">MIN_COMP_TO_CHECK =</span> <span class="dv">3</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">pred.attr =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">pred.method =</span> <span class="st">&quot;cenROC&quot;</span>, <span class="at">fast_mode =</span> F,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">MIN_EPV =</span> <span class="dv">5</span>, <span class="at">return_models =</span> F, <span class="at">remove_non_significant =</span> F, <span class="at">returnData =</span> F,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PARALLEL =</span> F, <span class="at">verbose =</span> F, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 5 components could be use.</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Training all possible models for SB.sPLS-DRCOX...</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 4 components could be use.</span></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Creating sub-models for SB.sPLS-DRCOX...</span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Evaluating COX models (AIC and C-Index)...</span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Evaluating prediction acuracy with Brier Score... [BEST_MODE]</span></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Evaluating prediction acuracy with cenROC algorithm... [BEST_MODE]</span></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Best model obtained.</span></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>cv.sb.splsdrcox_res <span class="co">#0.76min</span></span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The cross validation method used is cv.SB.sPLS-DRCOX.</span></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Best model is:</span></span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   n.comps eta n.var     AIC   c_index     BRIER       AUC     score</span></span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       2 0.5  5_16 292.342 0.7769054 0.1903569 0.6343857 0.9569306</span></span></code></pre></div>
<p>We will generate a SB.sPLS-DRCOX model with optimal number of
principal components and its penalty based on the results obtained from
the cross validation.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>sb.splsdrcox_model <span class="ot">&lt;-</span> <span class="fu">sb.splsdrcox</span>(<span class="at">X =</span> X_train, </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Y =</span> Y_train, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">n.comp =</span> cv.sb.splsdrcox_res<span class="sc">$</span>opt.comp, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">eta =</span> cv.sb.splsdrcox_res<span class="sc">$</span>opt.eta,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">x.center =</span> x.center, <span class="at">x.scale =</span> x.scale,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">remove_near_zero_variance =</span> T, <span class="at">remove_zero_variance =</span> F, <span class="at">toKeep.zv =</span> <span class="cn">NULL</span>, </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">remove_non_significant =</span> T, <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">MIN_EPV =</span> <span class="dv">5</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">returnData =</span> T, <span class="at">verbose =</span> F)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 5 components could be use.</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>sb.splsdrcox_model</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The method used is SB.sPLS-DRCOX.</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Survival model:</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                          coef exp(coef)     se(coef)    robust se        z</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp_2_mirna     1.416264e-06  1.000001 5.232575e-07 4.781115e-07 2.962205</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp_1_proteomic 9.238047e-01  2.518856 1.594113e-01 1.432416e-01 6.449275</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp_2_proteomic 4.563257e-01  1.578264 1.212955e-01 1.157985e-01 3.940686</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      Pr(&gt;|z|)</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp_2_mirna     3.054440e-03</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp_1_proteomic 1.123867e-10</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp_2_proteomic 8.124890e-05</span></span></code></pre></div>
<p>As before, we optimized each omic/block to use the same number of
components. But there is another methodology that allow to select a
different number of components and penalty per block call
“fast.cv.sb.splsdrcox”.</p>
<p>The cross validation returns the model automatically.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run cv.sb.splsicox</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>fast.sb.splsdrcox_model <span class="ot">&lt;-</span> <span class="fu">fast.cv.sb.splsdrcox</span>(<span class="at">X =</span> X_train, <span class="at">Y =</span> Y_train,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">max.ncomp =</span> <span class="dv">2</span>, <span class="at">eta.list =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.9</span>),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">n_run =</span> <span class="dv">2</span>, <span class="at">k_folds =</span> <span class="dv">10</span>, </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">x.center =</span> x.center, <span class="at">x.scale =</span> x.scale,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">remove_near_zero_variance =</span> T, <span class="at">remove_zero_variance =</span> F, <span class="at">toKeep.zv =</span> <span class="cn">NULL</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">remove_variance_at_fold_level =</span> F,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">remove_non_significant_models =</span> F, <span class="at">alpha =</span> <span class="fl">0.05</span>, </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">w_AIC =</span> <span class="dv">0</span>, <span class="at">w_c.index =</span> <span class="dv">0</span>, <span class="at">w_AUC =</span> <span class="dv">1</span>, <span class="at">w_BRIER =</span> <span class="dv">0</span>, <span class="at">times =</span> <span class="cn">NULL</span>, <span class="at">max_time_points =</span> <span class="dv">15</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">MIN_AUC_INCREASE =</span> <span class="fl">0.01</span>, <span class="at">MIN_AUC =</span> <span class="fl">0.8</span>, <span class="at">MIN_COMP_TO_CHECK =</span> <span class="dv">3</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">pred.attr =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">pred.method =</span> <span class="st">&quot;cenROC&quot;</span>, <span class="at">fast_mode =</span> F,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">MIN_EPV =</span> <span class="dv">5</span>, <span class="at">return_models =</span> F, <span class="at">remove_non_significant =</span> T,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">PARALLEL =</span> F, <span class="at">verbose =</span> F, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; As we are working with a multiblock approach with 2 blocks, a maximum of 5 components could be use.</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Running cross validation SB.sPLS-DRCOX for block: mirna</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Training all possible models for sPLS-DRCOX...</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Creating sub-models for sPLS-DRCOX...</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Evaluating COX models (AIC and C-Index)...</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Evaluating prediction acuracy with Brier Score... [BEST_MODE]</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Evaluating prediction acuracy with cenROC algorithm... [BEST_MODE]</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Best model obtained.</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Running cross validation SB.sPLS-DRCOX for block: proteomic</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Training all possible models for sPLS-DRCOX...</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Creating sub-models for sPLS-DRCOX...</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Evaluating COX models (AIC and C-Index)...</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Evaluating prediction acuracy with Brier Score... [BEST_MODE]</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Evaluating prediction acuracy with cenROC algorithm... [BEST_MODE]</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Best model obtained.</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>fast.sb.splsdrcox_model <span class="co">#0.8min</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The method used is SB.sPLS-DRCOX.</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; A total of 1 variables have been removed due to non-significance filter inside cox model.</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Survival model:</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                       coef exp(coef)  se(coef) robust se        z     Pr(&gt;|z|)</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp_1_proteomic 0.8557248  2.353079 0.1517433 0.1401724 6.104801 1.029287e-09</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp_2_proteomic 0.4254844  1.530332 0.1176525 0.1026072 4.146729 3.372583e-05</span></span></code></pre></div>
</div>
<div id="mb.spls-drcox" class="section level2">
<h2>MB.sPLS-DRCOX</h2>
<p>To enhance the versatility and performance of our survival analysis
methods, we have developed full multiblock survival models by combining
the sPLS-DRCOX methodology with the multiblock sPLS functions from the
mixOmics R package. This allows a full integration for omic by selecting
the components to reach the same objective.</p>
<p>In the creation of these methods, we utilized an heuristic variable
selection approach along with the MixOmics algorithms for hyperparameter
selection. The penalty is determined based on a vector of the number of
variables to test. Users have the flexibility to specify a specific
value for selecting a fixed number of variables. Alternatively, by
setting the value to NULL, the heuristic process automatically selects
the optimal number of variables.</p>
<p>Our method empowers users to define the minimum and maximum number of
variables to consider, as well as the number of cutpoints to test
between these limits. Through an iterative process, the algorithm
identifies the optimal number of variables and further explores the
performance of existing cutpoints compared to the selected optimal
value.</p>
<p>This integration of sPLS-DRCOX and multiblock sPLS provides
researchers with a powerful tool for conducting comprehensive
multivariate survival analysis.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run cv.splsdrcox</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>cv.mb.splsdrcox_res <span class="ot">&lt;-</span> <span class="fu">cv.mb.splsdrcox</span>(<span class="at">X =</span> X_train, <span class="at">Y =</span> Y_train, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">max.ncomp =</span> <span class="dv">2</span>, <span class="at">vector =</span> <span class="cn">NULL</span>, <span class="co">#NULL - autodetection</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">MIN_NVAR =</span> <span class="dv">10</span>, <span class="at">MAX_NVAR =</span> <span class="dv">1000</span>, <span class="at">n.cut_points =</span> <span class="dv">10</span>, <span class="at">EVAL_METHOD =</span> <span class="st">&quot;AUC&quot;</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">n_run =</span> <span class="dv">2</span>, <span class="at">k_folds =</span> <span class="dv">4</span>, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">x.center =</span> x.center, <span class="at">x.scale =</span> x.scale, </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">remove_near_zero_variance =</span> T, <span class="at">remove_zero_variance =</span> F, <span class="at">toKeep.zv =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">remove_variance_at_fold_level =</span> F,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">remove_non_significant_models =</span> F, <span class="at">alpha =</span> <span class="fl">0.05</span>, </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">w_AIC =</span> <span class="dv">0</span>, <span class="at">w_c.index =</span> <span class="dv">0</span>, <span class="at">w_AUC =</span> <span class="dv">1</span>, <span class="at">w_BRIER =</span> <span class="dv">0</span>, <span class="at">times =</span> <span class="cn">NULL</span>, <span class="at">max_time_points =</span> <span class="dv">15</span>,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">MIN_AUC_INCREASE =</span> <span class="fl">0.01</span>, <span class="at">MIN_AUC =</span> <span class="fl">0.8</span>, <span class="at">MIN_COMP_TO_CHECK =</span> <span class="dv">3</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">pred.attr =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">pred.method =</span> <span class="st">&quot;cenROC&quot;</span>, <span class="at">fast_mode =</span> F,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">MIN_EPV =</span> <span class="dv">5</span>, <span class="at">return_models =</span> F, <span class="at">remove_non_significant =</span> F, <span class="at">returnData =</span> F,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PARALLEL =</span> F, <span class="at">verbose =</span> F, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>cv.mb.splsdrcox_res <span class="co">#1.5min</span></span></code></pre></div>
<p>After getting the cross-validation, the full model could be optaon by
passing the optimizal number of components and the list of the number of
variables per omic.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mb.splsdrcox_model <span class="ot">&lt;-</span> <span class="fu">mb.splsdrcox</span>(<span class="at">X =</span> X_train, <span class="at">Y =</span> Y_train, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">n.comp =</span> cv.mb.splsdrcox_res<span class="sc">$</span>opt.comp,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vector =</span> cv.mb.splsdrcox_res<span class="sc">$</span>opt.nvar,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">x.center =</span> x.center, <span class="at">x.scale =</span> x.scale, </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">remove_near_zero_variance =</span> T, <span class="at">remove_zero_variance =</span> T, <span class="at">toKeep.zv =</span> <span class="cn">NULL</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">remove_non_significant =</span> T, <span class="at">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">MIN_AUC_INCREASE =</span> <span class="fl">0.01</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">pred.method =</span> <span class="st">&quot;cenROC&quot;</span>, <span class="at">max.iter =</span> <span class="dv">200</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">times =</span> <span class="cn">NULL</span>, <span class="at">max_time_points =</span> <span class="dv">15</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">MIN_EPV =</span> <span class="dv">5</span>, <span class="at">returnData =</span> T, <span class="at">verbose =</span> F)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in mb.splsdrcox(X = X_train, Y = Y_train, n.comp = cv.mb.splsdrcox_res$opt.comp, : objeto &#39;cv.mb.splsdrcox_res&#39; no encontrado</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>mb.splsdrcox_model</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;mb.splsdrcox_model&#39; no encontrado</span></span></code></pre></div>
<p>In some cases, if any component is significant, the model will keep
at least the one with the lower P-Value.</p>
</div>
<div id="mb.spls-dacox" class="section level2">
<h2>MB.sPLS-DACOX</h2>
<p>We also have extended our methodological repertoire with the
development of MB.sPLS-DACOX. Building upon the foundation of
sPLS-DACOX, this novel approach incorporates the powerful MultiBlock
functions from the MixOmics R package, further enhancing its
capabilities and performance.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run cv.splsdrcox</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>cv.mb.splsdacox_res <span class="ot">&lt;-</span> <span class="fu">cv.mb.splsdacox</span>(<span class="at">X =</span> X_train, <span class="at">Y =</span> Y_train, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">max.ncomp =</span> <span class="dv">2</span>, <span class="at">vector =</span> <span class="cn">NULL</span>, <span class="co">#NULL - autodetection</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">n_run =</span> <span class="dv">2</span>, <span class="at">k_folds =</span> <span class="dv">4</span>, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">x.center =</span> x.center, <span class="at">x.scale =</span> x.scale, </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">remove_near_zero_variance =</span> T, <span class="at">remove_zero_variance =</span> F, <span class="at">toKeep.zv =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">remove_variance_at_fold_level =</span> F,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">remove_non_significant_models =</span> F, <span class="at">alpha =</span> <span class="fl">0.05</span>, </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">w_AIC =</span> <span class="dv">0</span>, <span class="at">w_c.index =</span> <span class="dv">0</span>, <span class="at">w_AUC =</span> <span class="dv">1</span>, <span class="at">w_BRIER =</span> <span class="dv">0</span>, <span class="at">times =</span> <span class="cn">NULL</span>, <span class="at">max_time_points =</span> <span class="dv">15</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">MIN_AUC_INCREASE =</span> <span class="fl">0.01</span>, <span class="at">MIN_AUC =</span> <span class="fl">0.8</span>, <span class="at">MIN_COMP_TO_CHECK =</span> <span class="dv">3</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">pred.attr =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">pred.method =</span> <span class="st">&quot;cenROC&quot;</span>, <span class="at">fast_mode =</span> F,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">MIN_EPV =</span> <span class="dv">5</span>, <span class="at">return_models =</span> F, <span class="at">remove_non_significant =</span> F, <span class="at">returnData =</span> F,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PARALLEL =</span> F, <span class="at">verbose =</span> F, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>cv.mb.splsdacox_res <span class="co">#2min</span></span></code></pre></div>
<p>After getting the cross-validation, the full model could be optaon by
passing the optimizal number of components and the list of the number of
variables per omic.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>mb.splsdacox_model <span class="ot">&lt;-</span> <span class="fu">mb.splsdacox</span>(<span class="at">X =</span> X_train, <span class="at">Y =</span> Y_train, </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">n.comp =</span> cv.mb.splsdacox_res<span class="sc">$</span>opt.comp,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vector =</span> cv.mb.splsdacox_res<span class="sc">$</span>opt.nvar,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">x.center =</span> x.center, <span class="at">x.scale =</span> x.scale, </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">remove_near_zero_variance =</span> T, <span class="at">remove_zero_variance =</span> T, <span class="at">toKeep.zv =</span> <span class="cn">NULL</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">remove_non_significant =</span> T, <span class="at">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">MIN_AUC_INCREASE =</span> <span class="fl">0.01</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">pred.method =</span> <span class="st">&quot;cenROC&quot;</span>, <span class="at">max.iter =</span> <span class="dv">200</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">times =</span> <span class="cn">NULL</span>, <span class="at">max_time_points =</span> <span class="dv">15</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">MIN_EPV =</span> <span class="dv">5</span>, <span class="at">returnData =</span> T, <span class="at">verbose =</span> F)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in mb.splsdacox(X = X_train, Y = Y_train, n.comp = cv.mb.splsdacox_res$opt.comp, : objeto &#39;cv.mb.splsdacox_res&#39; no encontrado</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>mb.splsdacox_model</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;mb.splsdacox_model&#39; no encontrado</span></span></code></pre></div>
</div>
</div>
<div id="comparing-multiple-survival-models" class="section level1">
<h1>Comparing multiple survival models</h1>
<p>Next, we will analyze the results obtained from the multiple models
to see which one obtains the best predictions based on our data. To do
this, we will use the test set that has not been used for the training
of any model.</p>
<div id="comparing-for-multiple-evaluators-at-the-same-time." class="section level2">
<h2>Comparing for multiple evaluators at the same time.</h2>
<p>Initially, we will compare the area under the curve (AUC) for each of
the methods according to the evaluator we want. The function is
developed to simultaneously evaluate multiple evaluators. However, we
will continue working with a single evaluator. In this case “cenROC”. On
the other hand, we must provide a list of the different models as well
as the X and Y test set we want to evaluate.</p>
<p>When evaluating survival model results, we must indicate at which
temporal points we want to perform the evaluation. As we already
specified a NULL value for the “times” variable in the cross-validation,
we are going to let the algorithm to compute them again.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>lst_models <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;SB.sPLS-ICOX&quot;</span> <span class="ot">=</span> sb.splsicox_model,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;SB.sPLS-ICOX.fast&quot;</span> <span class="ot">=</span> fast.sb.splsicox_model,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;SB.sPLS-DRCOX&quot;</span> <span class="ot">=</span> sb.splsdrcox_model,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;SB.sPLS-DRCOX.fast&quot;</span> <span class="ot">=</span> fast.sb.splsdrcox_model,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;MB.sPLS-DRCOX&quot;</span> <span class="ot">=</span> mb.splsdrcox_model,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;MB.sPLS-DACOX&quot;</span> <span class="ot">=</span> mb.splsdacox_model)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;mb.splsdrcox_model&#39; no encontrado</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>eval_results <span class="ot">&lt;-</span> <span class="fu">eval_HDcox_models</span>(<span class="at">lst_models =</span> lst_models,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">X_test =</span> X_test, <span class="at">Y_test =</span> Y_test, </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">pred.method =</span> <span class="st">&quot;cenROC&quot;</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">pred.attr =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">times =</span> <span class="cn">NULL</span>, <span class="at">max_time_points =</span> <span class="dv">15</span>, </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">PARALLEL =</span> F)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in isa(lst_models, &quot;list&quot;): objeto &#39;lst_models&#39; no encontrado</span></span></code></pre></div>
<p>In case you prefer to test multiple AUC evaluators, a list of them
could be proportionate by using the library “purrr”.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>lst_evaluators <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">cenROC =</span> <span class="st">&quot;cenROC&quot;</span>,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">risksetROC =</span> <span class="st">&quot;risksetROC&quot;</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>eval_results <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(lst_evaluators, <span class="sc">~</span><span class="fu">eval_HDcox_models</span>(<span class="at">lst_models =</span> lst_models,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                                                              <span class="at">X_test =</span> X_test, <span class="at">Y_test =</span> Y_test,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                                                              <span class="at">pred.method =</span> .,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                                                              <span class="at">pred.attr =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                                                              <span class="at">times =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="fl">0.5</span>), </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                                                              <span class="at">max_time_points =</span> <span class="dv">15</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                                                              <span class="at">PARALLEL =</span> F))</span></code></pre></div>
<p>We can print the results obtained in the console where we can see,
for each of the selected methods, the training time and the time it took
to be evaluated, as well as their AIC, C-Index and AUC metrics and at
which time points it was evaluated.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>eval_results</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;eval_results&#39; no encontrado</span></span></code></pre></div>
</div>
<div id="plot-comparison" class="section level2">
<h2>Plot comparison</h2>
<p>However, we can also obtain graphical results where we can compare
each method over time, as well as their average scores using the
function “plot_evaluation” or “plot_evaluation.list” if multiple
evaluators have been tested. The user could choose to plot the AUC for
time prediction points or Brier Score. In case of use Brier Score,
instead of uses the Integrative Brier Score for the boxplots, the mean
or median is used (plot_evaluation parameter).</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>lst_eval_results <span class="ot">&lt;-</span> <span class="fu">plot_evaluation</span>(eval_results, <span class="at">evaluation =</span> <span class="st">&quot;AUC&quot;</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in plot_evaluation(eval_results, evaluation = &quot;AUC&quot;): objeto &#39;eval_results&#39; no encontrado</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>lst_eval_results_brier <span class="ot">&lt;-</span> <span class="fu">plot_evaluation</span>(eval_results, <span class="at">evaluation =</span> <span class="st">&quot;Brier&quot;</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in plot_evaluation(eval_results, evaluation = &quot;Brier&quot;): objeto &#39;eval_results&#39; no encontrado</span></span></code></pre></div>
<p>After performing the cross-validation, we obtain a list in R that
contains two new lists. The first of these refers to the evaluation over
time for each of the methods used, as well as a variant where the
average value of each of them is shown. On the other hand, we can
compare the mean results of each method using: T-test, Wilcoxon-test,
anova or Kruskal-Wallis.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>lst_eval_results<span class="sc">$</span>lst_plots<span class="sc">$</span>lineplot.mean</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;lst_eval_results&#39; no encontrado</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>lst_eval_results<span class="sc">$</span>lst_plot_comparisons<span class="sc">$</span>t.test</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;lst_eval_results&#39; no encontrado</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lst_eval_results$cenROC$lst_plots$lineplot.mean</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># lst_eval_results$cenROC$lst_plot_comparisons$t.test</span></span></code></pre></div>
</div>
<div id="computing-time-comparison-we-use-the-cross-validation-models" class="section level2">
<h2>Computing time comparison (we use the cross validation models)</h2>
<p>Another possible comparison is related to the computation times for
cross-validation, model creation, and evaluation. In this case,
cross-validations and methods are loaded.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>lst_models_time <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;cv.sb.splsicox&quot;</span> <span class="ot">=</span> cv.sb.splsicox_res,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;sb.splsicox&quot;</span> <span class="ot">=</span> sb.splsicox_model,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;fast.sb.splsicox&quot;</span> <span class="ot">=</span> fast.sb.splsicox_model,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;cv.sb.splsdrcox&quot;</span> <span class="ot">=</span> cv.sb.splsdrcox_res,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;sb.splsdrcox&quot;</span> <span class="ot">=</span> sb.splsdrcox_model,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;fast.sb.splsdrcox&quot;</span> <span class="ot">=</span> fast.sb.splsdrcox_model,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;cv.mb.splsdrcox&quot;</span> <span class="ot">=</span> cv.mb.splsdrcox_res,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;mb.splsdrcox&quot;</span> <span class="ot">=</span> mb.splsdrcox_model,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;cv.mb.splsdacox&quot;</span> <span class="ot">=</span> cv.mb.splsdrcox_res,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;mb.splsdacox&quot;</span> <span class="ot">=</span> mb.splsdacox_model,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Evaluation results&quot;</span> <span class="ot">=</span> eval_results)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;cv.mb.splsdrcox_res&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ggp_time <span class="ot">&lt;-</span> <span class="fu">plot_time.list</span>(lst_models_time)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in plot_time.list(lst_models_time): objeto &#39;lst_models_time&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ggp_time</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;ggp_time&#39; no encontrado</span></span></code></pre></div>
</div>
</div>
<div id="individual-interpretations-of-the-results" class="section level1">
<h1>Individual interpretations of the results</h1>
<p>Following the cross validation, we have selected the sPLS-DACOX
methodology as the most suitable model for our data. We will now study
and interpret its results based on the study variables or latent
variables used. In this case, we will examine some graphs of the
model.</p>
<div id="forest-plots" class="section level2">
<h2>Forest plots</h2>
<p>A forest plot can be obtained as the first graph using the survminer
R package. However, the function has been restructured to allow for
simultaneous launch of an HDcox class model or a list of HDcox models
using the plot_forest() or plot_forest.list() function.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>lst_forest_plot <span class="ot">&lt;-</span> <span class="fu">plot_forest.list</span>(lst_models)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in vctrs_vec_compat(.x, .purrr_user_env): objeto &#39;lst_models&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>lst_forest_plot<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;lst_forest_plot&#39; no encontrado</span></span></code></pre></div>
</div>
<div id="ph-assumption" class="section level2">
<h2>PH Assumption</h2>
<p>The following graph is related to one of the assumptions of the Cox
models, called proportional hazard.</p>
<p>In a Cox proportional hazards model, the proportional hazards
assumption states that the hazard ratio (the risk of experiencing the
event of interest) is constant over time for a given set of predictor
variables. This means that the effect of the predictors on the hazard
ratio does not change over time. This assumption is important because it
allows for the interpretation of the model’s coefficients as measures of
the effect of the predictors on the hazard ratio. Violations of the
proportional hazards assumption can occur if the effect of the
predictors on the hazard ratio changes over time or if there is an
interaction between the predictors and time. In these cases, the
coefficients of the model may not accurately reflect the effect of the
predictors on the hazard ratio and the results of the model may not be
reliable.</p>
<p>In this way, to visualize and check if the assumption is violated,
the function plot_proportionalHazard.list() or plot_proportionalHazard()
can be called, depending on whether a list of models or a specific model
is to be evaluated.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>lst_ph_ggplot <span class="ot">&lt;-</span> <span class="fu">plot_proportionalHazard.list</span>(lst_models)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in vctrs_vec_compat(.x, .purrr_user_env): objeto &#39;lst_models&#39; no encontrado</span></span></code></pre></div>
<p>Variables or components with a significant P-Value indicate that the
assumption is being violated.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>lst_ph_ggplot<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;lst_ph_ggplot&#39; no encontrado</span></span></code></pre></div>
</div>
<div id="density-plots" class="section level2">
<h2>Density plots</h2>
<p>Another type of graph implemented for all models, whether they belong
to the classical branch or to PLS-based models, is the visualization of
observations by event according to the values predicted by the Cox
models.</p>
<p>The R package “coxph” allows for several types of predictions to be
made on a Cox model that we use in our function, which are:</p>
<ul>
<li><p>Linear predictors “lp”: are the expected values of the response
variable (in this case, time until the event of interest) for each
observation, based on the Cox model. These values can be calculated from
the mean of the predictor variable values and the constant term of the
model.</p></li>
<li><p>Risk of experiencing an event “risk”: is a measure of the
probability that an event will occur for each observation, based on the
Cox model. The risk value can be calculated from the predictor values
and the constant term of the model.</p></li>
<li><p>Number of events expected to be experienced over time with these
specific individual characteristics “expected”: are the expected number
of events that would occur for each observation, based on the Cox model
and a specified period of time.</p></li>
<li><p>Terms: are the variables included in the Cox model.</p></li>
<li><p>Survival probability “survival”: is the probability that an
individual will not experience the event of interest during a specified
period of time, based on the Cox model. The survival probability can be
calculated from the predictor values and the constant term of the
model.</p></li>
</ul>
<p>According to the predicted value, we can classify the observations
along their possible values and see their distribution for each of the
different models.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>density.plots.lp <span class="ot">&lt;-</span> <span class="fu">plot_cox.event.list</span>(lst_models, <span class="at">type =</span> <span class="st">&quot;lp&quot;</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in vctrs_vec_compat(.x, .purrr_user_env): objeto &#39;lst_models&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>density.plots.lp<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span><span class="sc">$</span>plot.density</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;density.plots.lp&#39; no encontrado</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>density.plots.lp<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span><span class="sc">$</span>plot.histogram</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;density.plots.lp&#39; no encontrado</span></span></code></pre></div>
</div>
<div id="studying-pls-model" class="section level2">
<h2>Studying PLS model</h2>
<p>For those models based on PLS components, the PLS could be studied in
terms of loadings/scores. In order to get the plots, the function
plot_PLS_HDcox() has been developed where the user could specify to see
“scores”, “loadings” or a “biplot” for a couple of latent variables. By
default, if no factor is given, samples are grouped by event.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>ggp_scores <span class="ot">&lt;-</span> <span class="fu">plot_PLS_HDcox</span>(<span class="at">model =</span> lst_models<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span>,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">comp =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mode =</span> <span class="st">&quot;scores&quot;</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in isa(model, pkg.env$model_class): objeto &#39;lst_models&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>ggp_scores<span class="sc">$</span>plot_block</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;ggp_scores&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ggp_loadings <span class="ot">&lt;-</span> <span class="fu">plot_PLS_HDcox</span>(<span class="at">model =</span> lst_models<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span>, </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">comp =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mode =</span> <span class="st">&quot;loadings&quot;</span>,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">top =</span> <span class="dv">10</span>) <span class="co">#length from 0,0</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in isa(model, pkg.env$model_class): objeto &#39;lst_models&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>ggp_loadings<span class="sc">$</span>plot_block</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;ggp_loadings&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>ggp_biplot <span class="ot">&lt;-</span> <span class="fu">plot_PLS_HDcox</span>(<span class="at">model =</span> lst_models<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span>, </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">comp =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mode =</span> <span class="st">&quot;biplot&quot;</span>,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">top =</span> <span class="dv">15</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">only_top =</span> T)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in isa(model, pkg.env$model_class): objeto &#39;lst_models&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>ggp_biplot<span class="sc">$</span>plot_block</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;ggp_biplot&#39; no encontrado</span></span></code></pre></div>
</div>
</div>
<div id="understanding-the-results-in-terms-of-the-original-variables-pls-models" class="section level1">
<h1>Understanding the results in terms of the original variables (PLS
models)</h1>
<p>When a PLS-COX model is computed, the final survival model is based
on the PLS latent variables. Although those new variables can explain
the survival, in order to understand the disease, new coefficients could
be computed in terms of the original variables.</p>
<p>HDcox is able to transfer the component beta coefficient to original
variables by decomposing the coefficients by using the weight of the
variables in that latent variables.</p>
<div id="understanding-the-relative-contribution-per-variablecomponent" class="section level2">
<h2>Understanding the relative contribution per variable/component</h2>
<p>However, before studying the original variables, if a PLS model is
computed. HDcox also proportionates plots to see how many % of AUC is
computed per each component in order to see which components or latent
variables are more related to the observation survival.</p>
<p>The % of AUC explanation per component could be calculated for TRAIN
or TEST data. Train data was used to compute the best model, so the sum
of variables/components will generate a better LP (linear predictor)
performance. However, when test data is used, could happen that a
specific variable or a component could be a better predictor than the
full model.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>variable_auc_results <span class="ot">&lt;-</span> <span class="fu">eval_HDcox_model_per_variable</span>(<span class="at">model =</span> lst_models<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span>, </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">X_test =</span> lst_models<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span><span class="sc">$</span>X_input, </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">Y_test =</span> lst_models<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span><span class="sc">$</span>Y_input,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">pred.method =</span> <span class="st">&quot;cenROC&quot;</span>, <span class="at">pred.attr =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">times =</span> <span class="cn">NULL</span>, <span class="at">max_time_points =</span> <span class="dv">15</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">PARALLEL =</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in isa(lst_models, &quot;list&quot;): objeto &#39;lst_models&#39; no encontrado</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>variable_auc_plot_train <span class="ot">&lt;-</span> <span class="fu">plot_evaluation</span>(variable_auc_results, <span class="at">evaluation =</span> <span class="st">&quot;AUC&quot;</span>)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in plot_evaluation(variable_auc_results, evaluation = &quot;AUC&quot;): objeto &#39;variable_auc_results&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>variable_auc_plot_train<span class="sc">$</span>lst_plots<span class="sc">$</span>lineplot.mean</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;variable_auc_plot_train&#39; no encontrado</span></span></code></pre></div>
<p>The plot shows the AUC for the full model (called LP), and then, the
AUC per each variable (for classical methods) or components (for PLS
methods).</p>
</div>
<div id="psudobeta" class="section level2">
<h2>Psudobeta</h2>
<p>In order to improve the interpretability of a PLS model, a subset of
the most influential variables can be selected. In this example, the top
20 variables are chosen. Additionally, non-significant PLS components
are excluded by setting the “onlySig” parameter to “TRUE”.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>ggp.simulated_beta <span class="ot">&lt;-</span> <span class="fu">plot_pseudobeta.list</span>(<span class="at">lst_models =</span> lst_models, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">error.bar =</span> T, <span class="at">onlySig =</span> T, <span class="at">alpha =</span> <span class="fl">0.05</span>, </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">zero.rm =</span> T, <span class="at">auto.limits =</span> T, <span class="at">top =</span> <span class="dv">20</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">show_percentage =</span> T, <span class="at">size_percentage =</span> <span class="dv">2</span>, <span class="at">verbose =</span> F)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in vctrs_vec_compat(.x, .purrr_user_env): objeto &#39;lst_models&#39; no encontrado</span></span></code></pre></div>
<p>The SB.sPLS-DRCOX.fast model was computed using a total of 2
components. Although these components were classified as dangerous for
the observations (based on coefficients greater than one), certain
variables within the components may still have a protective effect,
depending on their individual weights.</p>
<p>The following plot illustrates the pseudo-beta coefficient for the
original variables in the SB.sPLS-DRCOX.fast model. As only the top 20
variables are shown, in some case a percentage of the total linear
predictor total value could be shown. To view the complete model, all
variables would need to be included in the plot by assigning the value
NULL to the “top” parameter.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>ggp.simulated_beta<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span><span class="sc">$</span>plot</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;ggp.simulated_beta&#39; no encontrado</span></span></code></pre></div>
</div>
<div id="kaplan-meier" class="section level2">
<h2>Kaplan-Meier</h2>
<p>For a more intuitive understanding of the model, the user can also
employ the “getAutoKM.list()” or “getAutoKM()” functions to generate
Kaplan-Meier curves. These functions allow the user to view the KM curve
for the entire model, a specific component of a PLS model, or for
individual variables.</p>
<div id="full-model" class="section level3">
<h3>Full model</h3>
<p>To run the full Kaplan-Meier model, the “type” parameter must be set
to “LP” (linear predictors). This means that the linear predictor value
for each patient will be used to divide the groups (in this case, the
score value multiplied by the Cox coefficient). The “surv_cutpoint”
function from the R package “survminer” is used to determine the optimal
cut-point. Other parameters are not used in this specific method.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>LST_KM_RES_LP <span class="ot">&lt;-</span> <span class="fu">getAutoKM.list</span>(<span class="at">type =</span> <span class="st">&quot;LP&quot;</span>,</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">lst_models =</span> lst_models,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">comp =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">top =</span> <span class="dv">10</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">ori_data =</span> T,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                                <span class="at">BREAKTIME =</span> <span class="cn">NULL</span>,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">only_sig =</span> T, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in vctrs_vec_compat(.x, .purrr_user_env): objeto &#39;lst_models&#39; no encontrado</span></span></code></pre></div>
<p>As a result, the Kaplan-Meier curve could be plotted.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>LST_KM_RES_LP<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span><span class="sc">$</span>LST_PLOTS<span class="sc">$</span>LP</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;LST_KM_RES_LP&#39; no encontrado</span></span></code></pre></div>
<p>After generating a Kaplan-Meier curve for the model, the cutoff
value, which is used to divide the observations into two groups, can be
used to evaluate how the test data is classified. The vector of cutoffs
for multiple models, when “getAutoKM.list()” is applied, can be
retrieved by using the function “getCutoffAutoKM.list()” and passing the
output of “getAutoKM.list()” as a parameter.</p>
<p>Once the vector is obtained, the function “getTestKM.list()” or
“getTestKM()” can be run with the list of models, the X test data, Y
test data, the list of cutoffs or a single value, and the desired number
of breaks for the new Kaplan-Meier plot.</p>
<p>A log-rank test will be displayed to determine if the chosen cutoff
is an effective way to split the data into groups with higher and lower
risk.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>lst_cutoff <span class="ot">&lt;-</span> <span class="fu">getCutoffAutoKM.list</span>(LST_KM_RES_LP)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in vctrs_vec_compat(.x, .purrr_user_env): objeto &#39;LST_KM_RES_LP&#39; no encontrado</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>LST_KM_TEST_LP <span class="ot">&lt;-</span> <span class="fu">getTestKM.list</span>(<span class="at">lst_models =</span> lst_models, </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">X_test =</span> X_test, <span class="at">Y_test =</span> Y_test, </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">type =</span> <span class="st">&quot;LP&quot;</span>,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">BREAKTIME =</span> <span class="cn">NULL</span>, <span class="at">n.breaks =</span> <span class="dv">20</span>,</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">lst_cutoff =</span> lst_cutoff)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in getTestKM.list(lst_models = lst_models, X_test = X_test, Y_test = Y_test, : objeto &#39;lst_models&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>LST_KM_TEST_LP<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;LST_KM_TEST_LP&#39; no encontrado</span></span></code></pre></div>
</div>
<div id="components" class="section level3">
<h3>Components</h3>
<p>To generate a Kaplan-Meier curve for a specific component, the “type”
parameter must be set to “COMP” (component). This means that the linear
predictor is computed using only one component at a time to split the
groups. In this case, the “comp” parameter can be used to specify which
component should be computed (if multiple components, each one will be
computed separately).</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>LST_KM_RES_COMP <span class="ot">&lt;-</span> <span class="fu">getAutoKM.list</span>(<span class="at">type =</span> <span class="st">&quot;COMP&quot;</span>,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">lst_models =</span> lst_models,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">comp =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">top =</span> <span class="dv">10</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">ori_data =</span> T,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">BREAKTIME =</span> <span class="cn">NULL</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">only_sig =</span> T, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in vctrs_vec_compat(.x, .purrr_user_env): objeto &#39;lst_models&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>LST_KM_RES_COMP<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span><span class="sc">$</span>LST_PLOTS<span class="sc">$</span>genes<span class="sc">$</span>comp_1</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;LST_KM_RES_COMP&#39; no encontrado</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>LST_KM_RES_COMP<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span><span class="sc">$</span>LST_PLOTS<span class="sc">$</span>clinical<span class="sc">$</span>comp_1</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;LST_KM_RES_COMP&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>lst_cutoff <span class="ot">&lt;-</span> <span class="fu">getCutoffAutoKM.list</span>(LST_KM_RES_COMP)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in vctrs_vec_compat(.x, .purrr_user_env): objeto &#39;LST_KM_RES_COMP&#39; no encontrado</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>LST_KM_TEST_COMP <span class="ot">&lt;-</span> <span class="fu">getTestKM.list</span>(<span class="at">lst_models =</span> lst_models, </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">X_test =</span> X_test, <span class="at">Y_test =</span> Y_test, </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">type =</span> <span class="st">&quot;COMP&quot;</span>,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">BREAKTIME =</span> <span class="cn">NULL</span>, <span class="at">n.breaks =</span> <span class="dv">20</span>,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">lst_cutoff =</span> lst_cutoff)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in vctrs_vec_compat(.x, .purrr_user_env): objeto &#39;lst_models&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>LST_KM_TEST_COMP<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span><span class="sc">$</span>comp_1_genes <span class="co"># all patients in same group</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;LST_KM_TEST_COMP&#39; no encontrado</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>LST_KM_TEST_COMP<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span><span class="sc">$</span>comp_1_miRNA <span class="co"># all patients in same group</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;LST_KM_TEST_COMP&#39; no encontrado</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>LST_KM_TEST_COMP<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span><span class="sc">$</span>comp_1_clinical <span class="co"># all patients in same group</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;LST_KM_TEST_COMP&#39; no encontrado</span></span></code></pre></div>
</div>
<div id="original-variables" class="section level3">
<h3>Original variables</h3>
<p>To generate a Kaplan-Meier curve for original variables, the “type”
parameter must be set to “VAR” (variable). In this case, the “ori_data”
parameter can be used to determine whether the original or normalized
values of the variables should be used.</p>
<p>Additionally, the “top” parameter can be used to plot a specific
number of variables, sorted by P-Value (Log-Rank test). The best
cutpoint is determined by the “surv_cutpoint” function. Both qualitative
and quantitative variables are supported.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>LST_KM_RES_VAR <span class="ot">&lt;-</span> <span class="fu">getAutoKM.list</span>(<span class="at">type =</span> <span class="st">&quot;VAR&quot;</span>,</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">lst_models =</span> lst_models,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">comp =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">top =</span> <span class="dv">10</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ori_data =</span> T,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">BREAKTIME =</span> <span class="cn">NULL</span>,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">only_sig =</span> T, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in vctrs_vec_compat(.x, .purrr_user_env): objeto &#39;lst_models&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>LST_KM_RES_VAR<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span><span class="sc">$</span>LST_PLOTS<span class="sc">$</span>proteomic<span class="sc">$</span><span class="st">`</span><span class="at">840</span><span class="st">`</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;LST_KM_RES_VAR&#39; no encontrado</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>LST_KM_RES_VAR<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span><span class="sc">$</span>LST_PLOTS<span class="sc">$</span>proteomic<span class="sc">$</span><span class="st">`</span><span class="at">3897</span><span class="st">`</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;LST_KM_RES_VAR&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>lst_cutoff <span class="ot">&lt;-</span> <span class="fu">getCutoffAutoKM.list</span>(LST_KM_RES_VAR)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in vctrs_vec_compat(.x, .purrr_user_env): objeto &#39;LST_KM_RES_VAR&#39; no encontrado</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>LST_KM_TEST_VAR <span class="ot">&lt;-</span> <span class="fu">getTestKM.list</span>(<span class="at">lst_models =</span> lst_models, </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">X_test =</span> X_test, <span class="at">Y_test =</span> Y_test, </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">type =</span> <span class="st">&quot;VAR&quot;</span>, <span class="at">ori_data =</span> T,</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">BREAKTIME =</span> <span class="cn">NULL</span>, <span class="at">n.breaks =</span> <span class="dv">20</span>,</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">lst_cutoff =</span> lst_cutoff)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in getTestKM.list(lst_models = lst_models, X_test = X_test, Y_test = Y_test, : objeto &#39;lst_models&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>LST_KM_TEST_VAR<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span><span class="sc">$</span>proteomic<span class="sc">$</span><span class="st">`</span><span class="at">840</span><span class="st">`</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;LST_KM_TEST_VAR&#39; no encontrado</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>LST_KM_TEST_VAR<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span><span class="sc">$</span>proteomic<span class="sc">$</span><span class="st">`</span><span class="at">3897</span><span class="st">`</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;LST_KM_TEST_VAR&#39; no encontrado</span></span></code></pre></div>
</div>
</div>
</div>
<div id="new-patients" class="section level1">
<h1>New patients</h1>
<p>In addition, HDCox can also manage new patients to perform
predictions.</p>
<p>To demonstrate, an observation from a test dataset will be used.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>new_pat <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="fu">names</span>(X_test)){</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  new_pat[[b]] <span class="ot">&lt;-</span> X_test[[b]][<span class="dv">1</span>,,drop<span class="ot">=</span>F]</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>As shown, this is a censored patient who has the last observation at
time 825.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(Y_test[<span class="fu">rownames</span>(new_pat<span class="sc">$</span>mirna),])</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">time</th>
<th align="left">event</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TCGA-A2-A0SV-01A</td>
<td align="right">825</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>The function “plot_pseudobeta_newPatient.list()” or
“plot_pseudobeta_newPatient()” allows the user to compare the
characteristics of a new patient with the pseudo-beta values obtained
from a specific model. The goal is to understand in a general way which
variables are associated with an increased risk of an event or a
decreased risk, in comparison to the variables predicted by the
model.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>ggp.simulated_beta_newPat <span class="ot">&lt;-</span> <span class="fu">plot_pseudobeta_newPatient.list</span>(<span class="at">lst_models =</span> lst_models, </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">new_observation =</span> new_pat,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">error.bar =</span> T, <span class="at">onlySig =</span> T, <span class="at">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">zero.rm =</span> T, <span class="at">auto.limits =</span> T, <span class="at">show.betas =</span> T, <span class="at">top =</span> <span class="dv">20</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in vctrs_vec_compat(.x, .purrr_user_env): objeto &#39;lst_models&#39; no encontrado</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ggp.simulated_beta_newPat &lt;- plot_pseudobeta_newPatient(model = lst_models$`SB.PLS-ICOX`,</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                         new_observation = new_pat,</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                         error.bar = T, onlySig = T, alpha = 0.05,</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                         zero.rm = T, auto.limits = T, show.betas = T, top = 20)</span></span></code></pre></div>
<p>On the left, a linear predictor value is shown for the observation
and each variable. On the right, the pseudo-beta coefficients for the
model’s original variables are illustrated. This allows the user to
compare the direction of the linear predictors per variable. A change in
direction means that the variable’s value is below the mean for hazard
variables or above the mean for protective ones. Having an opposite
direction for hazard variables and maintaining the direction for
protective variables makes the observation safer over time.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>ggp.simulated_beta_newPat<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span><span class="sc">$</span>plot<span class="sc">$</span>proteomic</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;ggp.simulated_beta_newPat&#39; no encontrado</span></span></code></pre></div>
<div id="add-patient-to-density-plot" class="section level2">
<h2>Add patient to density plot</h2>
<p>Additionally, the new observation can be added to the density and
histogram plots that the model has computed. While this function can be
useful in visualizing the results, it is important to note that no
definitive conclusions can be drawn from these types of plots alone.
They serve as an additional means of viewing the predictive values for
the new patient (“lp”, “risk”, “expected”, “terms”, “survival”) in
relation to the training dataset and its histogram or density plot,
along with the events or censored patients.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>pat_density <span class="ot">&lt;-</span> <span class="fu">plot_patient.eventDensity</span>(<span class="at">patient =</span> new_pat, </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">time =</span> <span class="cn">NULL</span>, </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">model =</span> lst_models<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span>, </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">type =</span> <span class="st">&quot;lp&quot;</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in predict.HDcox(object = model, newdata = new_data): objeto &#39;lst_models&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>pat_density</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;pat_density&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>pat_histogram <span class="ot">&lt;-</span> <span class="fu">plot_patient.eventHistogram</span>(<span class="at">patient =</span> new_pat, </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">time =</span> <span class="cn">NULL</span>, </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">model =</span> lst_models<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span>, </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">type =</span> <span class="st">&quot;lp&quot;</span>)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in predict.HDcox(object = model, newdata = new_data): objeto &#39;lst_models&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>pat_histogram</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;pat_histogram&#39; no encontrado</span></span></code></pre></div>
</div>
<div id="cox-compare-patients" class="section level2">
<h2>COX compare patients</h2>
<p>Furthermore, similar plots can be generated for multiple patients at
the same time. For example, by selecting 5 patients, individual linear
predictors for each variable and the final linear predictor using all
the variables used in the survival model can be plotted.</p>
<p>As an idea, this function could also be used to study the same
patient in different time points after receiving a treatment and study
its own evolution related to the original variables.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>sub_X_test <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="fu">names</span>(X_test)){</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  sub_X_test[[b]] <span class="ot">&lt;-</span> X_test[[b]][<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(Y_test[<span class="fu">rownames</span>(sub_X_test<span class="sc">$</span>proteomic),])</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">time</th>
<th align="left">event</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TCGA-A2-A0SV-01A</td>
<td align="right">825</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">TCGA-A2-A0YT-01A</td>
<td align="right">723</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">TCGA-BH-A1FB-01A</td>
<td align="right">3669</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">TCGA-D8-A1XC-01A</td>
<td align="right">377</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">TCGA-BH-A1EX-01A</td>
<td align="right">1508</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>To generate the figure, the function
“plot_LP.multiplePatients.list()” or “plot_LP.multiplePatients()” can be
used.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>lst_cox.comparison <span class="ot">&lt;-</span> <span class="fu">plot_LP.multiplePatients.list</span>(<span class="at">lst_models =</span> lst_models, </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">new_data =</span> sub_X_test, </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">error.bar =</span> T, <span class="at">zero.rm =</span> T, <span class="at">onlySig =</span> T, </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">top =</span> <span class="dv">5</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in vctrs_vec_compat(.x, .purrr_user_env): objeto &#39;lst_models&#39; no encontrado</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co"># lst_cox.comparison &lt;- plot_LP.multiplePatients(model = lst_models$`SB.PLS-ICOX`, </span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                                      df.pat = sub_X_test, </span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                                      error.bar = T, zero.rm = T, onlySig = T, alpha = 0.05, top = 5)</span></span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>lst_cox.comparison<span class="sc">$</span><span class="st">`</span><span class="at">SB.sPLS-DRCOX.fast</span><span class="st">`</span><span class="sc">$</span>plot</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;lst_cox.comparison&#39; no encontrado</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
